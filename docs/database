-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.club_invites (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  club_id uuid NOT NULL,
  email USER-DEFINED NOT NULL,
  role text NOT NULL DEFAULT 'officer'::text,
  request_id uuid,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  created_by uuid,
  accepted_at timestamp with time zone,
  accepted_by uuid,
  CONSTRAINT club_invites_pkey PRIMARY KEY (id),
  CONSTRAINT club_invites_club_id_fkey FOREIGN KEY (club_id) REFERENCES public.clubs(id),
  CONSTRAINT club_invites_request_id_fkey FOREIGN KEY (request_id) REFERENCES public.club_requests(id),
  CONSTRAINT club_invites_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT club_invites_accepted_by_fkey FOREIGN KEY (accepted_by) REFERENCES auth.users(id)
);
CREATE TABLE public.club_major_notes (
  club_id uuid NOT NULL,
  major_id uuid NOT NULL,
  note text NOT NULL,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT club_major_notes_pkey PRIMARY KEY (club_id, major_id),
  CONSTRAINT club_major_notes_club_id_fkey FOREIGN KEY (club_id) REFERENCES public.clubs(id),
  CONSTRAINT club_major_notes_major_id_fkey FOREIGN KEY (major_id) REFERENCES public.majors(id)
);
CREATE TABLE public.club_majors (
  club_id uuid NOT NULL,
  major_id uuid NOT NULL,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT club_majors_pkey PRIMARY KEY (club_id, major_id),
  CONSTRAINT club_majors_club_id_fkey FOREIGN KEY (club_id) REFERENCES public.clubs(id),
  CONSTRAINT club_majors_major_id_fkey FOREIGN KEY (major_id) REFERENCES public.majors(id)
);
CREATE TABLE public.club_memberships (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  club_id uuid NOT NULL,
  user_id uuid NOT NULL,
  role text NOT NULL DEFAULT 'officer'::text,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT club_memberships_pkey PRIMARY KEY (id),
  CONSTRAINT club_memberships_club_id_fkey FOREIGN KEY (club_id) REFERENCES public.clubs(id),
  CONSTRAINT club_memberships_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.club_request_major_notes (
  request_id uuid NOT NULL,
  major_id uuid NOT NULL,
  note text NOT NULL,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT club_request_major_notes_pkey PRIMARY KEY (request_id, major_id),
  CONSTRAINT club_request_major_notes_request_id_fkey FOREIGN KEY (request_id) REFERENCES public.club_requests(id),
  CONSTRAINT club_request_major_notes_major_id_fkey FOREIGN KEY (major_id) REFERENCES public.majors(id)
);
CREATE TABLE public.club_request_majors (
  request_id uuid NOT NULL,
  major_id uuid NOT NULL,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT club_request_majors_pkey PRIMARY KEY (request_id, major_id),
  CONSTRAINT club_request_majors_request_id_fkey FOREIGN KEY (request_id) REFERENCES public.club_requests(id),
  CONSTRAINT club_request_majors_major_id_fkey FOREIGN KEY (major_id) REFERENCES public.majors(id)
);
CREATE TABLE public.club_request_tags (
  request_id uuid NOT NULL,
  tag text NOT NULL,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT club_request_tags_pkey PRIMARY KEY (request_id, tag),
  CONSTRAINT club_request_tags_request_id_fkey FOREIGN KEY (request_id) REFERENCES public.club_requests(id)
);
CREATE TABLE public.club_requests (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  name text NOT NULL,
  description text NOT NULL,
  website text,
  slug_candidate text,
  contact_email text NOT NULL,
  officer_emails ARRAY NOT NULL DEFAULT '{}'::text[],
  officer_phones ARRAY NOT NULL DEFAULT '{}'::text[],
  logo_url text,
  banner_url text,
  status text NOT NULL DEFAULT 'pending'::text CHECK (status = ANY (ARRAY['pending'::text, 'approved'::text, 'rejected'::text])),
  admin_message text,
  reviewed_at timestamp with time zone,
  reviewed_by uuid,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  submitted_by uuid,
  updated_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT club_requests_pkey PRIMARY KEY (id),
  CONSTRAINT club_requests_submitted_by_fkey FOREIGN KEY (submitted_by) REFERENCES auth.users(id),
  CONSTRAINT club_requests_reviewed_by_fkey FOREIGN KEY (reviewed_by) REFERENCES auth.users(id)
);
CREATE TABLE public.club_tags (
  club_id uuid NOT NULL,
  tag text NOT NULL,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT club_tags_pkey PRIMARY KEY (club_id, tag),
  CONSTRAINT club_tags_club_id_fkey FOREIGN KEY (club_id) REFERENCES public.clubs(id)
);
CREATE TABLE public.clubs (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  name text NOT NULL,
  description text NOT NULL,
  website text,
  created_at timestamp with time zone DEFAULT now(),
  slug text UNIQUE,
  is_active boolean NOT NULL DEFAULT true,
  display_order integer NOT NULL DEFAULT 0,
  logo_url text,
  banner_url text,
  CONSTRAINT clubs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.events (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  club_id uuid NOT NULL,
  title text NOT NULL,
  description text,
  location text,
  start_at timestamp with time zone NOT NULL,
  end_at timestamp with time zone,
  url text,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT events_pkey PRIMARY KEY (id),
  CONSTRAINT events_club_id_fkey FOREIGN KEY (club_id) REFERENCES public.clubs(id)
);
CREATE TABLE public.majors (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  name text NOT NULL UNIQUE,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT majors_pkey PRIMARY KEY (id)
);
CREATE TABLE public.platform_admins (
  user_id uuid NOT NULL,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT platform_admins_pkey PRIMARY KEY (user_id),
  CONSTRAINT platform_admins_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);