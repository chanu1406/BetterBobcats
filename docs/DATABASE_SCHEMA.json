{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "BetterBobcats Database Schema",
  "description": "Complete database schema documentation for BetterBobcats platform. Update this file whenever schema changes are made.",
  "version": "1.0.0",
  "database": {
    "type": "PostgreSQL",
    "provider": "Supabase",
    "schema": "public"
  },
  "tables": {
    "clubs": {
      "description": "Student clubs and organizations at UC Merced",
      "primaryKey": "id",
      "columns": {
        "id": {
          "type": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "description": "Unique identifier for the club"
        },
        "name": {
          "type": "text",
          "nullable": false,
          "description": "Club name"
        },
        "description": {
          "type": "text",
          "nullable": false,
          "description": "Club description"
        },
        "website": {
          "type": "text",
          "nullable": true,
          "description": "Club website URL"
        },
        "slug": {
          "type": "text",
          "nullable": true,
          "unique": true,
          "description": "URL-friendly slug for the club"
        },
        "is_active": {
          "type": "boolean",
          "nullable": false,
          "default": true,
          "description": "Whether the club is currently active"
        },
        "display_order": {
          "type": "integer",
          "nullable": false,
          "default": 0,
          "description": "Order for displaying clubs (lower numbers appear first)"
        },
        "logo_url": {
          "type": "text",
          "nullable": true,
          "description": "URL to the club's logo image"
        },
        "banner_url": {
          "type": "text",
          "nullable": true,
          "description": "URL to the club's banner image"
        },
        "created_at": {
          "type": "timestamptz",
          "nullable": false,
          "default": "now()",
          "description": "Timestamp when the club was created"
        }
      },
      "indexes": [],
      "relationships": {
        "club_majors": {
          "type": "one-to-many",
          "table": "club_majors",
          "foreignKey": "club_id"
        },
        "club_tags": {
          "type": "one-to-many",
          "table": "club_tags",
          "foreignKey": "club_id"
        },
        "club_major_notes": {
          "type": "one-to-many",
          "table": "club_major_notes",
          "foreignKey": "club_id"
        }
      },
      "rowLevelSecurity": {
        "enabled": true,
        "policies": [
          {
            "name": "Enable read access for all users",
            "operation": "SELECT",
            "policy": "USING (true)"
          }
        ]
      }
    },
    "majors": {
      "description": "Academic majors/degree programs at UC Merced",
      "primaryKey": "id",
      "columns": {
        "id": {
          "type": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "description": "Unique identifier for the major"
        },
        "name": {
          "type": "text",
          "nullable": false,
          "unique": true,
          "description": "Major name (must be unique)"
        },
        "created_at": {
          "type": "timestamptz",
          "nullable": false,
          "default": "now()",
          "description": "Timestamp when the major was created"
        }
      },
      "indexes": [],
      "relationships": {
        "club_majors": {
          "type": "one-to-many",
          "table": "club_majors",
          "foreignKey": "major_id"
        },
        "club_major_notes": {
          "type": "one-to-many",
          "table": "club_major_notes",
          "foreignKey": "major_id"
        }
      },
      "rowLevelSecurity": {
        "enabled": true,
        "policies": [
          {
            "name": "Enable read access for all users",
            "operation": "SELECT",
            "policy": "USING (true)"
          }
        ]
      }
    },
    "club_majors": {
      "description": "Junction table linking clubs to majors (many-to-many relationship)",
      "primaryKey": ["club_id", "major_id"],
      "columns": {
        "club_id": {
          "type": "uuid",
          "nullable": false,
          "description": "Reference to clubs.id",
          "foreignKey": {
            "table": "clubs",
            "column": "id",
            "onDelete": "CASCADE"
          }
        },
        "major_id": {
          "type": "uuid",
          "nullable": false,
          "description": "Reference to majors.id",
          "foreignKey": {
            "table": "majors",
            "column": "id",
            "onDelete": "CASCADE"
          }
        },
        "created_at": {
          "type": "timestamptz",
          "nullable": false,
          "default": "now()",
          "description": "Timestamp when the relationship was created"
        }
      },
      "indexes": [
        {
          "name": "idx_club_majors_club_id",
          "columns": ["club_id"],
          "description": "Index for faster club lookups"
        },
        {
          "name": "idx_club_majors_major_id",
          "columns": ["major_id"],
          "description": "Index for faster major lookups"
        }
      ],
      "relationships": {
        "club": {
          "type": "many-to-one",
          "table": "clubs",
          "foreignKey": "club_id"
        },
        "major": {
          "type": "many-to-one",
          "table": "majors",
          "foreignKey": "major_id"
        }
      },
      "rowLevelSecurity": {
        "enabled": true,
        "policies": [
          {
            "name": "Enable read access for all users",
            "operation": "SELECT",
            "policy": "USING (true)"
          }
        ]
      }
    },
    "club_tags": {
      "description": "Tags associated with clubs for categorization and filtering",
      "primaryKey": ["club_id", "tag"],
      "columns": {
        "club_id": {
          "type": "uuid",
          "nullable": false,
          "description": "Reference to clubs.id",
          "foreignKey": {
            "table": "clubs",
            "column": "id"
          }
        },
        "tag": {
          "type": "text",
          "nullable": false,
          "description": "Tag name (e.g., 'STEM', 'Social', 'Professional')"
        },
        "created_at": {
          "type": "timestamptz",
          "nullable": false,
          "default": "now()",
          "description": "Timestamp when the tag was added"
        }
      },
      "indexes": [],
      "relationships": {
        "club": {
          "type": "many-to-one",
          "table": "clubs",
          "foreignKey": "club_id"
        }
      },
      "rowLevelSecurity": {
        "enabled": false
      }
    },
    "club_major_notes": {
      "description": "Notes about how a club relates to a specific major",
      "primaryKey": ["club_id", "major_id"],
      "columns": {
        "club_id": {
          "type": "uuid",
          "nullable": false,
          "description": "Reference to clubs.id",
          "foreignKey": {
            "table": "clubs",
            "column": "id"
          }
        },
        "major_id": {
          "type": "uuid",
          "nullable": false,
          "description": "Reference to majors.id",
          "foreignKey": {
            "table": "majors",
            "column": "id"
          }
        },
        "note": {
          "type": "text",
          "nullable": false,
          "description": "Note explaining the relationship between club and major"
        },
        "created_at": {
          "type": "timestamptz",
          "nullable": false,
          "default": "now()",
          "description": "Timestamp when the note was created"
        }
      },
      "indexes": [],
      "relationships": {
        "club": {
          "type": "many-to-one",
          "table": "clubs",
          "foreignKey": "club_id"
        },
        "major": {
          "type": "many-to-one",
          "table": "majors",
          "foreignKey": "major_id"
        }
      },
      "rowLevelSecurity": {
        "enabled": false
      }
    }
  },
  "relationships": {
    "clubs_to_majors": {
      "type": "many-to-many",
      "through": "club_majors",
      "description": "Clubs can be associated with multiple majors, and majors can have multiple clubs"
    },
    "clubs_to_tags": {
      "type": "one-to-many",
      "description": "Each club can have multiple tags"
    },
    "clubs_to_major_notes": {
      "type": "many-to-many",
      "through": "club_major_notes",
      "description": "Clubs can have notes about their relationship with specific majors"
    }
  },
  "businessRules": {
    "clubs": [
      "Club names should be unique within the system",
      "Only active clubs should be displayed in public listings",
      "Display order determines sorting (ascending, lower numbers first)"
    ],
    "majors": [
      "Major names must be unique",
      "Majors cannot be deleted if they have associated clubs"
    ],
    "club_majors": [
      "A club can be associated with multiple majors",
      "A major can have multiple clubs",
      "Deleting a club or major cascades to remove associations"
    ],
    "club_tags": [
      "Tags are case-sensitive",
      "Same tag can be used across multiple clubs"
    ]
  },
  "plannedTables": {
    "courses": {
      "description": "Course catalog with prerequisites, semesters, and academic year",
      "status": "planned",
      "notes": "Currently stored as JSON data, will be migrated to database"
    },
    "degrees": {
      "description": "Degree programs and their requirements",
      "status": "planned"
    },
    "careers": {
      "description": "Career paths and their associated courses",
      "status": "planned",
      "notes": "Currently stored as JSON data, will be migrated to database"
    },
    "roadmaps": {
      "description": "User-created academic roadmaps",
      "status": "planned"
    },
    "users": {
      "description": "User accounts for personalized features",
      "status": "planned"
    }
  },
  "lastUpdated": "2025-01-06",
  "migrationFiles": [
    "supabase/migrations/20260102000000_create_clubs_tables.sql",
    "supabase/migrations/20260102000001_update_club_websites.sql",
    "supabase/migrations/20260102000002_update_robotics_website.sql"
  ]
}

