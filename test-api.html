<!DOCTYPE html>
<html>
<head>
    <title>API Integration Test</title>
    <style>
        body {
            font-family: system-ui;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; }
        .loading { background: #d1ecf1; border: 1px solid #bee5eb; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>BetterBobcats API Integration Test</h1>
    
    <h2>Backend API Test</h2>
    <div id="backend-status" class="status loading">Testing backend...</div>
    <pre id="backend-data"></pre>

    <h2>Frontend API Client Test</h2>
    <div id="frontend-status" class="status loading">Testing frontend API client...</div>
    <pre id="frontend-data"></pre>

    <script>
        // Test 1: Direct backend API call
        fetch('http://localhost:8000/api/courses/')
            .then(r => r.json())
            .then(data => {
                document.getElementById('backend-status').className = 'status success';
                document.getElementById('backend-status').textContent = 
                    `✅ Backend API Working: ${data.length} courses loaded`;
                document.getElementById('backend-data').textContent = 
                    JSON.stringify(data.slice(0, 2), null, 2) + '\n... (showing first 2 courses)';
            })
            .catch(err => {
                document.getElementById('backend-status').className = 'status error';
                document.getElementById('backend-status').textContent = 
                    `❌ Backend Error: ${err.message}`;
            });

        // Test 2: Frontend's fetchCourses function (simulated)
        fetch('http://localhost:8000/api/courses/')
            .then(r => r.json())
            .then(data => {
                // Transform snake_case to camelCase (like the API client does)
                const transformed = data.map(course => ({
                    id: course.id,
                    code: course.code,
                    name: course.name,
                    fullName: course.full_name,
                    year: course.year,
                    semester: course.semester,
                    prerequisites: course.prerequisites || [],
                    isCategory: course.is_category,
                    category: course.category,
                }));
                
                document.getElementById('frontend-status').className = 'status success';
                document.getElementById('frontend-status').textContent = 
                    `✅ Frontend API Client Working: Transformed ${transformed.length} courses`;
                document.getElementById('frontend-data').textContent = 
                    JSON.stringify(transformed.slice(0, 2), null, 2) + '\n... (showing first 2 transformed courses)';
            })
            .catch(err => {
                document.getElementById('frontend-status').className = 'status error';
                document.getElementById('frontend-status').textContent = 
                    `❌ Frontend Error: ${err.message}`;
            });
    </script>
</body>
</html>
